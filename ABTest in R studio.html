
<!DOCTYPE html>
<html>
<head>
<style type="text/css">
.inline {
  background-color: #f7f7f7;
  border:solid 1px #B0B0B0;
}
.error {
	font-weight: bold;
	color: #FF0000;
}
.warning {
	font-weight: bold;
}
.message {
	font-style: italic;
}
.source, .output, .warning, .error, .message {
	padding: 0 1em;
  border:solid 1px #F7F7F7;
}
.source {
  background-color: #f5f5f5;
}
.left {
  text-align: left;
}
.right {
  text-align: right;
}
.center {
  text-align: center;
}
.hl.num {
  color: #AF0F91;
}
.hl.str {
  color: #317ECC;
}
.hl.com {
  color: #AD95AF;
  font-style: italic;
}
.hl.opt {
  color: #000000;
}
.hl.std {
  color: #585858;
}
.hl.kwa {
  color: #295F94;
  font-weight: bold;
}
.hl.kwb {
  color: #B05A65;
}
.hl.kwc {
  color: #55aa55;
}
.hl.kwd {
  color: #BC5A65;
  font-weight: bold;
}
</style>
  <script src="https://yihui.name/media/js/center-images.js"></script>
  <title>A Report Generated by knitr</title>
</head>
<body>

  <p>This report is automatically generated with the R
    package <a href="https://yihui.name/knitr/"><strong>knitr</strong></a>
    (version <code class="knitr inline">1.30</code>)
    .</p>

<div class="chunk" id="auto-report"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com">## This analysis will analyze the impact of a new product page on the effectiveness of customers</span>
<span class="hl com">## purchase. There are two product page one is current and another new, with current page the </span>
<span class="hl com">## conversion rate is 13%, and the management will consider the new page successful if the </span>
<span class="hl com">## conversion rate with new page is 15%. We will check if there is at least 2% statistical </span>
<span class="hl com">## significant difference. This project is the continuous from my Python project, just doing </span>
<span class="hl com">## same project in R. This analysis will analyze the sample from the main data calculated in python.</span>

<span class="hl com"># Hypothesis</span>
<span class="hl com"># Null Hypothesis: Both current and new page have same conversion rate (or purchase rate)</span>
<span class="hl com"># Alternative Hypothesis: Both are different, new page has higher conversion rate.</span>

<span class="hl kwd">library</span><span class="hl std">(tidyverse)</span>
<span class="hl std">ABTest</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">read.csv</span><span class="hl std">(</span><span class="hl str">'ABTest_R.csv'</span><span class="hl std">)</span>

<span class="hl com"># calculating conversion for control group and treatment group and their corresponding conversion rates.</span>
<span class="hl com"># filter conversions for control group</span>
<span class="hl std">conversion_subset_control</span> <span class="hl kwb">&lt;-</span> <span class="hl std">ABTest</span> <span class="hl opt">%&gt;%</span> <span class="hl kwd">filter</span><span class="hl std">(group</span> <span class="hl opt">==</span> <span class="hl str">&quot;control&quot;</span> <span class="hl opt">&amp;</span> <span class="hl std">converted</span> <span class="hl opt">==</span> <span class="hl num">1</span><span class="hl std">)</span>
<span class="hl com"># Total number of conversion for control group</span>
<span class="hl std">Conversion_control</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">nrow</span><span class="hl std">(conversion_subset_control)</span>
<span class="hl com"># Number of visitors for control group</span>
<span class="hl std">visitors_control</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">nrow</span><span class="hl std">(ABTest</span> <span class="hl opt">%&gt;%</span> <span class="hl kwd">filter</span><span class="hl std">(group</span> <span class="hl opt">==</span> <span class="hl str">'control'</span><span class="hl std">))</span>
<span class="hl com"># conversion_rate_control</span>
<span class="hl std">conv_rate_control</span> <span class="hl kwb">&lt;-</span> <span class="hl std">(Conversion_control</span><span class="hl opt">/</span><span class="hl std">visitors_control)</span>
<span class="hl kwd">print</span><span class="hl std">(conv_rate_control)</span> <span class="hl com">#0.1233 or 12%</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 0.1233051
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># filter conversions for treatment group</span>
<span class="hl std">conversion_subset_treatment</span> <span class="hl kwb">&lt;-</span> <span class="hl std">ABTest</span><span class="hl opt">%&gt;%</span><span class="hl kwd">filter</span><span class="hl std">(group</span> <span class="hl opt">==</span> <span class="hl str">&quot;treatment&quot;</span> <span class="hl opt">&amp;</span> <span class="hl std">converted</span> <span class="hl opt">==</span> <span class="hl num">1</span><span class="hl std">)</span>
<span class="hl com"># Total number of conversion for treatment group</span>
<span class="hl std">conversion_treatment</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">nrow</span><span class="hl std">(conversion_subset_treatment)</span>
<span class="hl com"># Number of visitors for treatment group</span>
<span class="hl std">visitors_treatment</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">nrow</span><span class="hl std">(ABTest</span> <span class="hl opt">%&gt;%</span> <span class="hl kwd">filter</span><span class="hl std">(group</span> <span class="hl opt">==</span> <span class="hl str">'treatment'</span><span class="hl std">))</span>
<span class="hl com"># conversion_rate_treatment</span>
<span class="hl std">conv_rate_treatment</span> <span class="hl kwb">&lt;-</span> <span class="hl std">(conversion_treatment</span> <span class="hl opt">/</span> <span class="hl std">visitors_treatment)</span>
<span class="hl kwd">print</span><span class="hl std">(conv_rate_treatment)</span> <span class="hl com"># 0.125 or 12.5% conversion for treatment</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 0.1256356
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com">#now compute the relative uplift using the conversion rates for control and treatment groups.</span>
<span class="hl com"># the uplift is a percentage of the increase.</span>
<span class="hl std">uplift</span> <span class="hl kwb">&lt;-</span> <span class="hl std">(conv_rate_treatment</span> <span class="hl opt">-</span> <span class="hl std">conv_rate_control)</span> <span class="hl opt">/</span> <span class="hl std">conv_rate_control</span> <span class="hl opt">*</span> <span class="hl num">100</span>
<span class="hl std">uplift</span> <span class="hl com"># 1.89% which suggests treatment group has 1.8% increase in conversion rate over control group, the increase is small.</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 1.890034
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># calculate the pooled probability, standard error, margin of error and difference in proportion</span>
    <span class="hl com"># (point estimate) for variants A &amp; B.</span>
<span class="hl com"># Pooled sample proportion for control group and treatment group</span>
<span class="hl std">p_pool</span> <span class="hl kwb">&lt;-</span> <span class="hl std">(Conversion_control</span> <span class="hl opt">+</span> <span class="hl std">conversion_treatment)</span> <span class="hl opt">/</span> <span class="hl std">(visitors_control</span> <span class="hl opt">+</span> <span class="hl std">visitors_treatment)</span>
<span class="hl kwd">print</span><span class="hl std">(p_pool)</span> <span class="hl com">#0.125 </span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 0.1244703
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># compute Standard error for control group and treatment group </span>
<span class="hl std">SE_pool</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sqrt</span><span class="hl std">(p_pool</span> <span class="hl opt">*</span> <span class="hl std">(</span><span class="hl num">1</span> <span class="hl opt">-</span> <span class="hl std">p_pool)</span> <span class="hl opt">*</span> <span class="hl std">((</span><span class="hl num">1</span><span class="hl opt">/</span><span class="hl std">visitors_control)</span> <span class="hl opt">+</span> <span class="hl std">(</span><span class="hl num">1</span><span class="hl opt">/</span><span class="hl std">visitors_treatment)))</span>
<span class="hl kwd">print</span><span class="hl std">(SE_pool)</span> <span class="hl com"># 0.00679</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 0.006795358
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># margin of error for the pool</span>
<span class="hl std">MOE</span> <span class="hl kwb">&lt;-</span> <span class="hl std">SE_pool</span> <span class="hl opt">*</span> <span class="hl kwd">qnorm</span><span class="hl std">(</span><span class="hl num">0.975</span><span class="hl std">)</span>
<span class="hl kwd">print</span><span class="hl std">(MOE)</span> <span class="hl com">#0.0133</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 0.01331866
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Point Estimate or Difference in proportion</span>
<span class="hl std">d_hat</span> <span class="hl kwb">&lt;-</span> <span class="hl std">conv_rate_treatment</span> <span class="hl opt">-</span> <span class="hl std">conv_rate_control</span>

<span class="hl com"># Compute the Z-score to check the p-value</span>
<span class="hl std">z_score</span> <span class="hl kwb">&lt;-</span> <span class="hl std">d_hat</span><span class="hl opt">/</span><span class="hl std">SE_pool</span>
<span class="hl kwd">print</span><span class="hl std">(z_score)</span> <span class="hl com">#0.3429</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 0.3429559
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com">## get p-value from the z_score</span>
<span class="hl std">p_value</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">pnorm</span><span class="hl std">(</span><span class="hl kwc">q</span> <span class="hl std">=</span> <span class="hl opt">-</span><span class="hl std">z_score,</span> <span class="hl kwc">mean</span> <span class="hl std">=</span> <span class="hl num">0</span><span class="hl std">,</span> <span class="hl kwc">sd</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl std">)</span> <span class="hl opt">*</span> <span class="hl num">2</span>
<span class="hl kwd">print</span><span class="hl std">(p_value)</span> <span class="hl com">#0.73 high p value means we can't reject null hypothesis, i.e., there is </span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 0.7316316
</pre></div>
<div class="source"><pre class="knitr r">            <span class="hl com"># no difference between control and experiment group or new page is not effective.</span>

<span class="hl com"># lets verify the result from the p_value from the confidence interval</span>
<span class="hl com"># calculate the confidence interval for the pool using the pre-calculated results</span>
<span class="hl std">ci</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">c</span><span class="hl std">(d_hat</span> <span class="hl opt">-</span> <span class="hl std">MOE, d_hat</span> <span class="hl opt">+</span> <span class="hl std">MOE)</span>
<span class="hl std">ci</span> <span class="hl com"># -0.0109 &amp; 0.0156</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] -0.01098815  0.01564917
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># confidence interval for the control group</span>
<span class="hl std">X_hat_control</span> <span class="hl kwb">&lt;-</span> <span class="hl std">Conversion_control</span><span class="hl opt">/</span><span class="hl std">visitors_control</span>
<span class="hl std">se_hat_Control</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sqrt</span><span class="hl std">(X_hat_control</span><span class="hl opt">*</span><span class="hl std">(</span><span class="hl num">1</span><span class="hl opt">-</span><span class="hl std">X_hat_control)</span><span class="hl opt">/</span><span class="hl std">visitors_control)</span>
<span class="hl std">ci_control</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">c</span><span class="hl std">(X_hat_control</span> <span class="hl opt">-</span> <span class="hl kwd">qnorm</span><span class="hl std">(</span><span class="hl num">0.975</span><span class="hl std">)</span><span class="hl opt">*</span><span class="hl std">se_hat_Control, X_hat_control</span> <span class="hl opt">+</span> <span class="hl kwd">qnorm</span><span class="hl std">(</span><span class="hl num">0.975</span><span class="hl std">)</span><span class="hl opt">*</span><span class="hl std">se_hat_Control)</span>
<span class="hl kwd">print</span><span class="hl std">(ci_control)</span> <span class="hl com">#0.1139 &amp; 0.1327</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 0.1139253 0.1326848
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># calculate confidence interval for treatment group</span>
<span class="hl std">X_hat_treatment</span> <span class="hl kwb">&lt;-</span> <span class="hl std">conversion_treatment</span><span class="hl opt">/</span><span class="hl std">visitors_control</span>
<span class="hl std">se_hat_treatment</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sqrt</span><span class="hl std">(X_hat_treatment</span><span class="hl opt">*</span><span class="hl std">(</span><span class="hl num">1</span><span class="hl opt">-</span><span class="hl std">X_hat_treatment)</span><span class="hl opt">/</span><span class="hl std">visitors_control)</span>
<span class="hl std">ci_treatment</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">c</span><span class="hl std">(X_hat_treatment</span> <span class="hl opt">-</span> <span class="hl kwd">qnorm</span><span class="hl std">(</span><span class="hl num">0.975</span><span class="hl std">)</span><span class="hl opt">*</span><span class="hl std">se_hat_treatment, X_hat_treatment</span> <span class="hl opt">+</span> <span class="hl kwd">qnorm</span><span class="hl std">(</span><span class="hl num">0.975</span><span class="hl std">)</span><span class="hl opt">*</span><span class="hl std">se_hat_treatment)</span>
<span class="hl kwd">print</span><span class="hl std">(ci_treatment)</span> <span class="hl com">#0.116 &amp; 0.135</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 0.1161802 0.1350910
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># confidence interval also shows the presence of 13% but lack of 15%. so new page is not effective.</span>

<span class="hl com"># This test suggests that there is no difference between the control group and experiment groups, </span>
<span class="hl com"># so the new page is not effective in increasing the number of conversion rate.</span>
</pre></div>
</div></div>

  <p>The R session information (including the OS info, R version and all
    packages used):</p>

<div class="chunk" id="session-info"><div class="rcode"><div class="source"><pre class="knitr r">    <span class="hl kwd">sessionInfo</span><span class="hl std">()</span>
</pre></div>
<div class="output"><pre class="knitr r">## R version 4.0.3 (2020-10-10)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 10 x64 (build 19042)
## 
## Matrix products: default
## 
## locale:
## [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United States.1252   
## [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C                          
## [5] LC_TIME=English_United States.1252    
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] forcats_0.5.1   stringr_1.4.0   dplyr_1.0.2     purrr_0.3.4     readr_1.4.0    
## [6] tidyr_1.1.2     tibble_3.0.4    ggplot2_3.3.3   tidyverse_1.3.0
## 
## loaded via a namespace (and not attached):
##  [1] nlme_3.1-149         fs_1.5.0             xts_0.12.1           lubridate_1.7.9.2   
##  [5] bit64_4.0.5          doParallel_1.0.16    httr_1.4.2           bsts_0.9.5          
##  [9] tools_4.0.3          backports_1.2.1      utf8_1.1.4           R6_2.5.0            
## [13] rpart_4.1-15         DBI_1.1.1            colorspace_2.0-0     nnet_7.3-14         
## [17] withr_2.4.0          tidyselect_1.1.0     bit_4.0.4            compiler_4.0.3      
## [21] cli_2.2.0            rvest_0.3.6          xml2_1.3.2           scales_1.1.1        
## [25] odbc_1.3.0           proxy_0.4-24         dtw_1.22-3           digest_0.6.27       
## [29] rmarkdown_2.6        Boom_0.9.6           pkgconfig_2.0.3      htmltools_0.5.1     
## [33] highr_0.8            dbplyr_2.0.0         rlang_0.4.10         readxl_1.3.1        
## [37] rstudioapi_0.13      generics_0.1.0       zoo_1.8-8            jsonlite_1.7.2      
## [41] ModelMetrics_1.2.2.2 magrittr_2.0.1       Matrix_1.2-18        fansi_0.4.1         
## [45] Rcpp_1.0.6           munsell_0.5.0        lifecycle_0.2.0      CausalImpact_1.2.5  
## [49] stringi_1.5.3        pROC_1.17.0.1        yaml_2.2.1           MASS_7.3-53         
## [53] plyr_1.8.6           recipes_0.1.15       grid_4.0.3           blob_1.2.1          
## [57] parallel_4.0.3       BoomSpikeSlab_1.2.3  crayon_1.3.4         lattice_0.20-41     
## [61] haven_2.3.1          splines_4.0.3        hms_1.0.0            knitr_1.30          
## [65] pillar_1.4.7         MarketMatching_1.2.0 reshape2_1.4.4       codetools_0.2-16    
## [69] stats4_4.0.3         reprex_1.0.0         glue_1.4.2           evaluate_0.14       
## [73] data.table_1.13.6    modelr_0.1.8         vctrs_0.3.6          foreach_1.5.1       
## [77] cellranger_1.1.0     gtable_0.3.0         assertthat_0.2.1     xfun_0.20           
## [81] gower_0.2.2          prodlim_2019.11.13   broom_0.7.4          class_7.3-17        
## [85] survival_3.2-7       timeDate_3043.102    iterators_1.0.13     tinytex_0.29        
## [89] lava_1.6.8.1         ellipsis_0.3.1       caret_6.0-86         ipred_0.9-9
</pre></div>
<div class="source"><pre class="knitr r">    <span class="hl kwd">Sys.time</span><span class="hl std">()</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] &quot;2021-04-11 20:55:30 EDT&quot;
</pre></div>
</div></div>


</body>
</html>
